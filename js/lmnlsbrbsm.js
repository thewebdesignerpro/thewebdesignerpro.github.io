/**
 * author Armstrong "Army" Chiu
 * URL: https://thewebdesignerpro.com/     
 */
 
 
import*as THREE from"three";import WebGL from"three/addons/capabilities/WebGL.js";import{OBJLoader}from"three/addons/loaders/OBJLoader.js";const idleTO=120,florY=0,ceilY=140;let camera,scene,renderer,clock;const grups=[];let mixer,isMobil=!1,mouseX=0,mouseY=-50;const ui={},_={},x={};if(WebGL.isWebGL2Available())window.addEventListener?window.addEventListener("load",init,!1):window.attachEvent?window.attachEvent("onload",init):window.onload=init;else{const e=WebGL.getWebGL2ErrorMessage();kontainer.appendChild(e),kontainer.style.background="url('img/liminalsuburbsl.jpg') center top no-repeat",kontainer.style.backgroundSize="cover",fader.style.opacity=0,fader.style.display="none",fader.parentNode.removeChild(fader),cL(loadr,0,"paus"),loadr.style.display="none",loadr.parentNode.removeChild(loadr)}function eL(e,a,t,r){0==a?e.addEventListener(t,r,!1):e.removeEventListener(t,r,!1)}function cL(e,a,t){0==a?e.classList.contains(t)||e.classList.add(t):e.classList.contains(t)&&e.classList.remove(t)}function init(){function e(e){return document.getElementById(e)}ui.kontainer=e("kontainer"),ui.onAud=e("onAud"),ui.offAud=e("offAud"),ui.loadr=e("loadr"),ui.fader=e("fader"),ui.fader.style.opacity=1;let a=document.createElement("div");a.setAttribute("id","dummy"),document.body.appendChild(a),isMobil="9000px"!=window.getComputedStyle(a,null).getPropertyValue("left"),isMobil&&(document.addEventListener("gesturechange",(function(e){e.preventDefault()}),!1),ui.kontainer.addEventListener("gesturechange",(function(e){e.preventDefault()}),!1),_.prevW=_.prevH=0),a.parentNode.removeChild(a),_.width=window.innerWidth,_.height=window.innerHeight,document.body.style.width=ui.kontainer.style.width=_.width+"px",document.body.style.height=ui.kontainer.style.height=_.height+"px",ui.kontainer.style.backgroundColor="#d7d9db";const t=14146011;if(_.ej=[],_.ej[0]=0,_.ej[1]=-1,_.ej[2]=Math.PI,_.ej[3]=-100,_.ej[4]=0,_.ej[5]=75,x.zz=450,renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!1}),renderer.setPixelRatio(window.devicePixelRatio),renderer.setSize(_.width,_.height),renderer.setClearColor(t,1),renderer.shadowMap.enabled=!0,renderer.shadowMap.type=THREE.PCFSoftShadowMap,renderer.outputColorSpace=THREE.LinearSRGBColorSpace,renderer.sortObjects=!1,ui.kontainer.appendChild(renderer.domElement),!1===renderer.capabilities.isWebGL2&&!renderer.extensions.get("OES_texture_float"))throw alert("OES_texture_float not supported"),"missing webgl extension";if(!1===renderer.capabilities.isWebGL2&&!renderer.extensions.get("OES_texture_float_linear"))throw alert("OES_texture_float_linear not supported"),"missing webgl extension";scene=new THREE.Scene,scene.fog=new THREE.FogExp2(t,48e-5),x.camGrup=new THREE.Group,camera=new THREE.PerspectiveCamera(50,_.width/_.height,1,2e4),camera.position.set(0,_.ej[5],_.ej[3]),x.camGrup.add(camera),scene.add(new THREE.AmbientLight(14803425)),x.camGrup.position.set(0,0,4e3),scene.add(x.camGrup);x.directionalLight=new THREE.DirectionalLight(16777215,5),x.directionalLight.castShadow=!0,x.directionalLight.shadow.mapSize.width=1024,x.directionalLight.shadow.mapSize.height=1024,x.directionalLight.shadow.camera.far=8e3,x.directionalLight.shadow.camera.left=-3e3,x.directionalLight.shadow.camera.bottom=-4e3,x.directionalLight.shadow.camera.right=3e3,x.directionalLight.shadow.camera.top=4e3,x.directionalLight.position.set(0,750,4e3),x.directionalLight.shadow.intensity=.9,scene.add(x.directionalLight),eL(window,1,"load",init),eL(window,0,"resize",onWindowResize),x.rotCam=!1,clock=new THREE.Clock,clock.autoStart=!1,grups[0]=new THREE.Group,grups[1]=new THREE.Group,_.mouse=new THREE.Vector2,_.entro=!0,_.idleTimer=0,_.fokus=!0,_.pointer=new THREE.Vector2,_.ptrDown=!1,x.currGrup=0,x.target0=new THREE.Object3D,x.target0.position.set(0,_.ej[5],_.ej[3]-500),x.camGrup.add(x.target0),addClouds(),addRoads(),addHouses(),addPavements(),addCurb(),addCurbS(),addTrees(),addGrass(),addLamps(),onWindowResize()}function addClouds(){const e=new THREE.SphereGeometry(2e3,32,16,0,2*Math.PI,0,Math.PI/2),a=new THREE.MeshBasicMaterial({color:16777215,side:THREE.BackSide,fog:!1}),t=new THREE.Mesh(e,a);t.rotation.y=-1.2,t.position.z=-2e3,x.camGrup.add(t);let r=new THREE.TextureLoader;new THREE.TextureLoader;r.load("img/skybox/14/dome2.jpg",(function(e){t.material.map=e,t.material.needsUpdate=!0}))}function addRoads(){x.road=[];const e=[],a=new THREE.PlaneGeometry(400,8e3);for(let t=0;t<1;t++)e[t]=new THREE.MeshStandardMaterial({color:16777215,roughness:1,metalness:1}),e[t].wireframe=!0,x.road[t]=new THREE.Mesh(a,e[t]),x.road[t].position.set(0,florY-10,0),x.road[t].rotation.x=Math.PI/-2,x.road[t].receiveShadow=!0,scene.add(x.road[t]);const t=new THREE.TextureLoader,r=new THREE.TextureLoader,n=new THREE.TextureLoader,o=new THREE.TextureLoader,i="img/road/1/";t.load(i+"color1b.jpg",(function(e){e.wrapS=e.wrapT=THREE.RepeatWrapping,e.repeat.set(1.5,30),x.road[0].material.map=e,x.road[0].material.needsUpdate=!0,x.road[0].material.wireframe=!1})),r.load(i+"rough1.jpg",(function(e){e.wrapS=e.wrapT=THREE.RepeatWrapping,e.repeat.set(1.5,30),x.road[0].material.roughnessMap=e,x.road[0].material.needsUpdate=!0})),n.load(i+"normal1.jpg",(function(e){e.wrapS=e.wrapT=THREE.RepeatWrapping,e.repeat.set(1.5,30),x.road[0].material.normalMap=e,x.road[0].material.needsUpdate=!0})),o.load("img/metaltmp.jpg",(function(e){x.road[0].material.metalnessMap=e,x.road[0].material.needsUpdate=!0})),grups[0].position.z=2e3,grups[1].position.z=-2e3,scene.add(grups[0]),scene.add(grups[1])}function addPavements(){x.pavement=[];const e=[540,-540],a=new THREE.PlaneGeometry(600,8e3),t=new THREE.MeshStandardMaterial({color:16777215,roughness:1,metalness:0});for(let r=0;r<2;r++)t.wireframe=!0,x.pavement[r]=new THREE.Mesh(a,t),x.pavement[r].position.set(e[r],florY,0),x.pavement[r].rotation.x=Math.PI/-2,x.pavement[r].receiveShadow=!0,scene.add(x.pavement[r]);const r=new THREE.TextureLoader,n=new THREE.TextureLoader,o=new THREE.TextureLoader,i="img/ground/6/";r.load(i+"color1b.jpg",(function(e){e.wrapS=e.wrapT=THREE.RepeatWrapping,e.repeat.set(3,40),t.map=e,t.needsUpdate=!0,t.wireframe=!1})),n.load(i+"rough1.jpg",(function(e){e.wrapS=e.wrapT=THREE.RepeatWrapping,e.repeat.set(3,40),t.roughnessMap=e,t.needsUpdate=!0})),o.load(i+"normal1.jpg",(function(e){e.wrapS=e.wrapT=THREE.RepeatWrapping,e.repeat.set(3,40),t.normalScale.set(-3,-3),t.normalMap=e,t.needsUpdate=!0}))}function addGrass(){x.grass=[];const e=[440,-440],a=[],t=new THREE.PlaneGeometry(400,8e3);for(let r=0;r<2;r++){a[r]=new THREE.MeshStandardMaterial({color:16777215,roughness:1,metalness:0}),a[r].alphaTest=.5,a[r].wireframe=!0,x.grass[r]=new THREE.Mesh(t,a[r]),x.grass[r].position.set(e[r],florY+.2,0);let n=Math.PI/-2;x.grass[r].rotation.x=n,x.grass[r].receiveShadow=!0,scene.add(x.grass[r])}const r=new THREE.TextureLoader,n=new THREE.TextureLoader,o=new THREE.TextureLoader,i=new THREE.TextureLoader,d=new THREE.TextureLoader,s="img/ground/10/";r.load(s+"color1.jpg",(function(e){e.wrapS=e.wrapT=THREE.RepeatWrapping,e.repeat.set(3,60),a[0].map=a[1].map=e,a[0].needsUpdate=a[1].needsUpdate=!0,a[0].wireframe=a[1].wireframe=!1})),n.load(s+"rough1.jpg",(function(e){e.wrapS=e.wrapT=THREE.RepeatWrapping,e.repeat.set(3,60),a[0].roughnessMap=a[1].roughnessMap=e,a[0].needsUpdate=a[1].needsUpdate=!0})),o.load(s+"normal1.jpg",(function(e){e.wrapS=e.wrapT=THREE.RepeatWrapping,e.repeat.set(3,60),a[0].normalMap=a[1].normalMap=e,a[0].needsUpdate=a[1].needsUpdate=!0})),i.load("img/opacLiminal.jpg",(function(e){e.wrapS=THREE.MirroredRepeatWrapping,e.wrapT=THREE.RepeatWrapping,e.repeat.set(2,8),a[0].alphaMap=e,a[0].needsUpdate=!0})),d.load("img/opacLiminal.jpg",(function(e){e.wrapS=THREE.MirroredRepeatWrapping,e.wrapT=THREE.RepeatWrapping,e.repeat.set(2,8),e.offset.set(0,-.173),a[1].alphaMap=e,a[1].needsUpdate=!0}))}function addCurb(){x.curb=[];const e=[195,-195,189,-189,188,-188],a=[],t=new THREE.PlaneGeometry(10,8e3);for(let r=0;r<2;r++){a[r]=new THREE.MeshStandardMaterial({color:15658734,roughness:.5,metalness:0}),a[r].alphaTest=.5,a[r].wireframe=!0,x.curb[r]=new THREE.Mesh(t,a[r]),x.curb[r].position.set(e[r],florY+.9,0);const n=Math.PI/-2;x.curb[r].rotation.x=n,x.curb[r].receiveShadow=!0,scene.add(x.curb[r])}const r=new THREE.PlaneGeometry(3,8e3);for(let t=2;t<4;t++){x.curb[t]=new THREE.Mesh(r,a[t-2]),x.curb[t].position.set(e[t],florY-.1,0);const n=Math.PI/-2,o=Math.PI/4;x.curb[t].rotation.x=n,x.curb[t].rotation.y=2==t?-1*o:o,x.curb[t].receiveShadow=!0,scene.add(x.curb[t])}for(let r=4;r<6;r++){x.curb[r]=new THREE.Mesh(t,a[r-4]),x.curb[r].position.set(e[r],florY-5.95,0);const n=Math.PI/-2,o=Math.PI/2;x.curb[r].rotation.x=n,x.curb[r].rotation.y=4==r?-1*o:o,x.curb[r].receiveShadow=!0,scene.add(x.curb[r])}addSidewalk()}function randomizeMatrix2(e,a){const t=new THREE.Vector3,r=new THREE.Euler,n=new THREE.Quaternion,o=new THREE.Vector3;return t.x=214,t.y=florY-4,t.z=3e3-a%8*1e3,n.setFromEuler(r),o.x=o.y=o.z=1,e.compose(t,n,o)}function randomizeMatrix3(e,a){const t=new THREE.Vector3,r=new THREE.Euler,n=new THREE.Quaternion,o=new THREE.Vector3;return t.x=-214,t.y=florY-4,t.z=3e3-a%8*1e3+497,n.setFromEuler(r),o.x=o.y=o.z=1,e.compose(t,n,o)}function addCurbS(){x.curbS=[];const e=new THREE.PlaneGeometry(52,10),a=new THREE.MeshStandardMaterial({color:9342606,roughness:.5,metalness:0,alphaTest:.5});a.wireframe=!0;for(let t=0;t<2;t++){const r=e.attributes.position.array.length,n=8;x.curbS[t]=new THREE.BatchedMesh(n,r,2*r,a),x.curbS[t].receiveShadow=!0;const o=x.curbS[t].addGeometry(e);let i=new THREE.Matrix4;for(let e=0;e<n;e++){const a=x.curbS[t].addInstance(o);i=0==t?randomizeMatrix2(i,e):randomizeMatrix3(i,e),x.curbS[t].setMatrixAt(a,i)}scene.add(x.curbS[t])}let t=new THREE.TextureLoader,r=new THREE.TextureLoader;t.load("img/curb2C.jpg",(function(e){e.wrapS=e.wrapT=THREE.MirroredRepeatWrapping,e.repeat.set(4,1),a.map=e,a.needsUpdate=!0,a.wireframe=!1})),r.load("img/opacCurb2.jpg",(function(e){a.alphaMap=e,a.needsUpdate=!0}))}function addSidewalk(){x.sidewalk=[];const e=[220,-220,214.5,-214.5],a=[],t=new THREE.PlaneGeometry(40,8e3);for(let r=0;r<2;r++){a[r]=new THREE.MeshStandardMaterial({color:16777215,roughness:1,metalness:0}),a[r].alphaTest=.5,a[r].wireframe=!0,x.sidewalk[r]=new THREE.Mesh(t,a[r]),x.sidewalk[r].position.set(e[r],florY+.8,0);const n=Math.PI/-2;x.sidewalk[r].rotation.x=n,x.sidewalk[r].receiveShadow=!0,scene.add(x.sidewalk[r])}const r=new THREE.PlaneGeometry(55,8e3);for(let t=2;t<4;t++){a[t]=new THREE.MeshStandardMaterial({color:13816530,roughness:1,metalness:0}),a[t].alphaTest=.5,x.sidewalk[t]=new THREE.Mesh(r,a[t]),x.sidewalk[t].position.set(e[t],florY-4.4,0);const n=Math.PI/-2,o=Math.PI/18;x.sidewalk[t].rotation.x=n,x.sidewalk[t].rotation.y=2==t?-1*o:o,x.sidewalk[t].receiveShadow=!0,scene.add(x.sidewalk[t])}const n=new THREE.TextureLoader,o=new THREE.TextureLoader,i=new THREE.TextureLoader,d=new THREE.TextureLoader,s=new THREE.TextureLoader,l=new THREE.TextureLoader,p=new THREE.TextureLoader,u="img/ground/7/";n.load(u+"color1.jpg",(function(e){e.wrapS=e.wrapT=THREE.RepeatWrapping,e.repeat.set(.1,40);for(let t=0;t<4;t++)a[t].map=e,a[t].needsUpdate=!0,a[t].wireframe=!1;x.curb[0].material.map=x.curb[1].material.map=e,x.curb[0].material.needsUpdate=x.curb[1].material.needsUpdate=!0,x.curb[0].material.wireframe=x.curb[1].material.wireframe=!1})),o.load(u+"rough1.jpg",(function(e){e.wrapS=e.wrapT=THREE.RepeatWrapping,e.repeat.set(.1,40);for(let t=0;t<4;t++)a[t].roughnessMap=e,a[t].needsUpdate=!0;x.curb[0].material.roughnessMap=x.curb[1].material.roughnessMap=e,x.curb[0].material.needsUpdate=x.curb[1].material.needsUpdate=!0})),i.load(u+"normal1.jpg",(function(e){e.wrapS=e.wrapT=THREE.RepeatWrapping,e.repeat.set(.1,40);for(let t=0;t<4;t++)a[t].normalMap=e,a[t].needsUpdate=!0;x.curb[0].material.normalMap=x.curb[1].material.normalMap=e,x.curb[0].material.needsUpdate=x.curb[1].material.needsUpdate=!0})),d.load("img/opacSidewalk.jpg",(function(e){e.wrapS=THREE.MirroredRepeatWrapping,e.wrapT=THREE.RepeatWrapping,e.repeat.set(1,8),a[0].alphaMap=e,a[0].needsUpdate=!0,x.curb[0].material.alphaMap=e,x.curb[0].material.needsUpdate=!0})),s.load("img/opacSidewalk.jpg",(function(e){e.wrapS=THREE.MirroredRepeatWrapping,e.wrapT=THREE.RepeatWrapping,e.repeat.set(1,8),e.offset.set(0,.497),a[1].alphaMap=e,a[1].needsUpdate=!0,x.curb[1].material.alphaMap=e,x.curb[1].material.needsUpdate=!0})),l.load("img/opacSidewalk2.jpg",(function(e){e.wrapS=THREE.MirroredRepeatWrapping,e.wrapT=THREE.RepeatWrapping,e.repeat.set(1,8),a[2].alphaMap=e,a[2].needsUpdate=!0})),p.load("img/opacSidewalk2.jpg",(function(e){e.wrapS=THREE.MirroredRepeatWrapping,e.wrapT=THREE.RepeatWrapping,e.repeat.set(1,8),e.offset.set(0,.497),a[3].alphaMap=e,a[3].needsUpdate=!0}))}function randomizeMatrix(e,a){const t=new THREE.Vector3,r=new THREE.Euler,n=new THREE.Quaternion,o=new THREE.Vector3,i=a<8?-800:800;t.x=i,t.y=0,t.z=3e3-a%8*1e3+435;const d=a<8?Math.PI/2:Math.PI/-2;return r.y=d,n.setFromEuler(r),o.x=o.y=o.z=35,e.compose(t,n,o)}function addHouses(){x.houses=[];(new OBJLoader).load("obj/house/2/house.obj",(function(e){e.traverse((function(e){e.isMesh&&e.geometry.computeBoundingBox()}));const a=new THREE.MeshStandardMaterial({color:16777215,roughness:1});a.wireframe=!0;const t=e.children[0].geometry.attributes.position.array.length;x.houses[0]=new THREE.BatchedMesh(16,t,2*t,a),x.houses[0].frustumCulled=!0,x.houses[0].castShadow=!0,x.houses[0].receiveShadow=!0;const r=x.houses[0].addGeometry(e.children[0].geometry);let n=new THREE.Matrix4;for(let e=0;e<16;e++){const a=x.houses[0].addInstance(r);n=randomizeMatrix(n,e),x.houses[0].setMatrixAt(a,n)}scene.add(x.houses[0]);let o=new THREE.TextureLoader,i=new THREE.TextureLoader,d=new THREE.TextureLoader,s=(new THREE.TextureLoader,"obj/house/2/mat/");o.load(s+"color1.jpg",(function(e){a.map=e,a.needsUpdate=!0,a.wireframe=!1})),i.load(s+"rough0.jpg",(function(e){a.roughnessMap=e,a.needsUpdate=!0})),d.load(s+"normal1.jpg",(function(e){a.normalMap=e,a.needsUpdate=!0}))}))}function randomizeMatrix4(e,a){const t=new THREE.Vector3,r=new THREE.Euler,n=new THREE.Quaternion,o=new THREE.Vector3,i=a<8?280:-280;t.x=i,t.y=0,t.z=3e3-a%8*1e3+435;const d=[0,Math.PI/2,Math.PI,Math.PI/4],s=[Math.PI,Math.PI/-2,0,Math.PI/-4];return r.y=a<8?d[a%4]:s[a%4],n.setFromEuler(r),o.x=o.y=o.z=2.6,e.compose(t,n,o)}function addTrees(){x.materials2=[],x.leaves=[],x.trunk=[];(new OBJLoader).load("obj/trees/11/tree.obj",(function(e){e.traverse((function(e){e.isMesh&&e.geometry.computeBoundingBox()})),x.materials2[0]=new THREE.MeshStandardMaterial({color:16777215,roughness:.5,alphaTest:.4}),x.materials2[0].side=2,x.materials2[0].shadowSide=THREE.BackSide,x.materials2[1]=new THREE.MeshStandardMaterial({color:16777215,roughness:1});for(let a=0;a<1;a++){const t=e.children[0].geometry.attributes.position.array.length,r=e.children[1].geometry.attributes.position.array.length,n=16;x.leaves[a]=new THREE.BatchedMesh(n,t,2*t,x.materials2[0]),x.leaves[a].frustumCulled=!0,x.leaves[a].castShadow=!0,x.trunk[a]=new THREE.BatchedMesh(n,r,2*r,x.materials2[1]),x.trunk[a].frustumCulled=!0,x.trunk[a].castShadow=x.trunk[a].receiveShadow=!0;const o=x.leaves[a].addGeometry(e.children[0].geometry),i=x.trunk[a].addGeometry(e.children[1].geometry);let d=new THREE.Matrix4;for(let e=0;e<n;e++){const t=x.leaves[a].addInstance(o),r=x.trunk[a].addInstance(i);d=randomizeMatrix4(d,e),x.leaves[a].setMatrixAt(t,d),x.trunk[a].setMatrixAt(r,d)}scene.add(x.leaves[a]),scene.add(x.trunk[a]),x.leaves[a].visible=x.trunk[a].visible=!1}const a=new THREE.TextureLoader,t=new THREE.TextureLoader,r=new THREE.TextureLoader,n=new THREE.TextureLoader,o=new THREE.TextureLoader,i=new THREE.TextureLoader,d="obj/trees/11/mat/";a.load(d+"color1.jpg",(function(e){x.materials2[0].map=e,x.materials2[0].needsUpdate=!0;for(let e=0;e<1;e++)x.trunk[e].visible=!0})),t.load(d+"alfa1.jpg",(function(e){x.materials2[0].alphaMap=e,x.materials2[0].needsUpdate=!0;for(let e=0;e<1;e++)x.leaves[e].visible=!0})),r.load(d+"normal1.jpg",(function(e){x.materials2[0].normalMap=e,x.materials2[0].needsUpdate=!0;for(let e=0;e<1;e++)x.leaves[e].visible=!0})),n.load(d+"color2.jpg",(function(e){x.materials2[1].map=e,x.materials2[1].needsUpdate=!0;for(let e=0;e<1;e++)x.trunk[e].visible=!0})),o.load(d+"rough2.jpg",(function(e){x.materials2[1].roughnessMap=e,x.materials2[1].needsUpdate=!0;for(let e=0;e<1;e++)x.leaves[e].visible=!0})),i.load(d+"normal2.jpg",(function(e){x.materials2[0].normalMap=e,x.materials2[0].needsUpdate=!0;for(let e=0;e<1;e++)x.leaves[e].visible=!0;fadeScene()}))}))}function randomizeMatrix5(e,a){const t=new THREE.Vector3,r=new THREE.Euler,n=new THREE.Quaternion,o=new THREE.Vector3,i=a<8?195:-195;return t.x=i,t.y=174,t.z=3e3-a%8*1e3+937,a<8&&(r.y=Math.PI),n.setFromEuler(r),o.x=o.y=o.z=.6,e.compose(t,n,o)}function addLamps(){x.lamps=[],x.bulbs=[];(new OBJLoader).load("obj/lamp/model.obj",(function(e){e.traverse((function(e){e.isMesh&&e.geometry.computeBoundingBox()}));const a=new THREE.MeshStandardMaterial({color:16777215,roughness:.4,metalness:.3}),t=new THREE.MeshStandardMaterial({color:16777215,roughness:0,metalness:.5});for(let r=0;r<1;r++){const n=e.children[0].geometry.attributes.position.array.length,o=e.children[1].geometry.attributes.position.array.length,i=16;x.lamps[r]=new THREE.BatchedMesh(i,n,2*n,a),x.lamps[r].frustumCulled=!0,x.lamps[r].castShadow=x.lamps[r].receiveShadow=!0,x.bulbs[r]=new THREE.BatchedMesh(i,o,2*o,t),x.bulbs[r].frustumCulled=!0;const d=x.lamps[r].addGeometry(e.children[0].geometry),s=x.bulbs[r].addGeometry(e.children[1].geometry);let l=new THREE.Matrix4;for(let e=0;e<i;e++){const a=x.lamps[r].addInstance(d),t=x.bulbs[r].addInstance(s);l=randomizeMatrix5(l,e),x.lamps[r].setMatrixAt(a,l),x.bulbs[r].setMatrixAt(t,l)}scene.add(x.lamps[r]),scene.add(x.bulbs[r]),x.lamps[r].visible=x.bulbs[r].visible=!1}const r=new THREE.TextureLoader,n=new THREE.TextureLoader,o="obj/lamp/mat/";r.load(o+"color1.jpg",(function(e){a.map=e,a.needsUpdate=!0;for(let e=0;e<1;e++)x.lamps[e].visible=x.bulbs[e].visible=!0})),n.load(o+"normal1.jpg",(function(e){a.normalMap=e,a.needsUpdate=!0;for(let e=0;e<1;e++)x.lamps[e].visible=x.bulbs[e].visible=!0}))}))}function fadeScene(){onWindowResize(),function e(){let a=parseFloat(ui.fader.style.opacity);(a-=.05)<0?(ui.fader.style.opacity=0,ui.fader.style.display="none",ui.fader.parentNode.removeChild(ui.fader),onWindowResize(),eL(ui.kontainer,0,"pointerdown",onPointerDown),eL(ui.kontainer,0,"pointermove",onPointerMove),animate(),theOptions(),cL(ui.loadr,0,"paus"),ui.loadr.style.display="none",ui.loadr.parentNode.removeChild(ui.loadr)):(ui.fader.style.opacity=a,requestAnimationFrame(e))}()}function theOptions(){isMobil?(eL(ui.onAud,0,"touchstart",audClick),eL(ui.offAud,0,"touchstart",audClick)):(eL(ui.onAud,0,"click",audClick),eL(ui.offAud,0,"click",audClick))}function audClick(e){e&&e.preventDefault(),x.sound?x.sound.isPlaying?(cL(ui.offAud,0,"noneIt2"),cL(ui.onAud,1,"noneIt2"),x.sound.pause()):(cL(ui.onAud,0,"noneIt2"),cL(ui.offAud,1,"noneIt2"),x.sound.play()):addAud(),_.idleTimer=0}function onPointerDown(e){e&&e.preventDefault();let a={};e.clientX?(a.x=e.clientX/_.width*2-1,a.y=-e.clientY/_.height*2+1):(a.x=e.x/_.width*2-1,a.y=-e.y/_.height*2+1),_.ptrDown=!0,_.pointer.x=a.x,_.pointer.y=a.y,_.idleTimer=0}function onPointerMove(e){e&&e.preventDefault();let a={};e.clientX?(a.x=e.clientX/_.width*2-1,a.y=-e.clientY/_.height*2+1):(a.x=e.x/_.width*2-1,a.y=-e.y/_.height*2+1),_.pointer.x=a.x,_.pointer.y=a.y,_.idleTimer=0}function wheelE(e){e&&e.preventDefault(),_.idleTimer=0}function onWindowResize(){_.width=window.innerWidth,_.height=window.innerHeight,isMobil&&(_.width==_.prevW&&(_.width=_.prevH,_.height=_.prevW),_.prevW=_.width,_.prevH=_.height),_.widthH=_.width/2,_.heightH=_.height/2,document.body.style.width=ui.kontainer.style.width=_.width+"px",document.body.style.height=ui.kontainer.style.height=_.height+"px",camera.aspect=_.width/_.height,camera.updateProjectionMatrix(),renderer.setSize(_.width,_.height),_.width>_.height?cntnt.style.fontSize=cntnt2.style.fontSize=(_.width+_.height)/2*.022+"px":cntnt.style.fontSize=cntnt2.style.fontSize=(_.width+_.height)/2*.028+"px",_.idleTimer=0}function animWalk(){let e=x.camGrup.position.z;x.camGrup.position.z=e>0?e-1:4e3}function animate(){if(requestAnimationFrame(animate),_.idleTimer<idleTO){clock.running||clock.start();const e=.001*Date.now();animWalk(),camera.position.x=2*Math.cos(4*e),camera.position.y=3*Math.sin(8*e)+_.ej[5],isMobil?(camera.rotation.y=.2*Math.sin(.8*e),camera.rotation.x=.2*Math.cos(.5*e)):(camera.rotation.y=-.22*_.pointer.x,camera.rotation.x=.2*_.pointer.y),_.idleTimer+=.01,render()}else clock.running&&clock.stop(),x.sound&&x.sound.isPlaying&&x.sound.pause();document.hasFocus()?_.fokus||(_.idleTimer=0,_.fokus=!0,x.sound&&(x.sound.isPlaying||x.sound.play())):(_.idleTimer=idleTO,_.fokus=!1,x.sound&&x.sound.isPlaying&&x.sound.pause())}function render(){renderer.render(scene,camera)}function addAud(){if(!x.sound){let e="lmnlsbrbs";e+=".mp3";const a=new THREE.AudioListener;camera.add(a),x.sound=new THREE.Audio(a);(new THREE.AudioLoader).load("aud/"+e,(function(e){x.sound.setBuffer(e),x.sound.setLoop(!0),x.sound.setVolume(.8),x.sound.play(),cL(ui.onAud,0,"noneIt2"),cL(ui.offAud,1,"noneIt2")}))}}
	