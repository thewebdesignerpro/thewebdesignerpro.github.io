/**
 * author Armstrong "Army" Chiu
 * URL: https://thewebdesignerpro.com/     
 */
 
import*as e from"three";import t from"three/addons/capabilities/WebGL.js";let idleTO=120,florY=-10,ceilY=140,camera,scene,renderer,clock,grups=[],isMobil=!1,mouseX=0,mouseY=-50,mixer,ui={},_={},x={};if(t.isWebGL2Available())window.addEventListener?window.addEventListener("load",init,!1):window.attachEvent?window.attachEvent("onload",init):window.onload=init;else{let n=t.getWebGL2ErrorMessage();kontainer.appendChild(n),kontainer.style.background="url('img/earthl.jpg') center top no-repeat",kontainer.style.backgroundSize="cover",fader.style.opacity=0,fader.style.display="none",fader.parentNode.removeChild(fader),cL(loadr,0,"paus"),loadr.style.display="none",loadr.parentNode.removeChild(loadr)}function eL(e,t,n,i){0==t?e.addEventListener(n,i,!1):e.removeEventListener(n,i,!1)}function cL(e,t,n){0==t?e.classList.contains(n)||e.classList.add(n):e.classList.contains(n)&&e.classList.remove(n)}function init(){function t(e){return document.getElementById(e)}ui.kontainer=t("kontainer"),ui.onAud=t("onAud"),ui.offAud=t("offAud"),ui.loadr=t("loadr"),ui.fader=t("fader"),ui.fader.style.opacity=1;let n=document.createElement("div");if(n.setAttribute("id","dummy"),document.body.appendChild(n),(isMobil="9000px"!=window.getComputedStyle(n,null).getPropertyValue("left"))&&(document.addEventListener("gesturechange",function(e){e.preventDefault()},!1),ui.kontainer.addEventListener("gesturechange",function(e){e.preventDefault()},!1),_.prevW=_.prevH=0),n.parentNode.removeChild(n),_.width=window.innerWidth,_.height=window.innerHeight,document.body.style.width=ui.kontainer.style.width=_.width+"px",document.body.style.height=ui.kontainer.style.height=_.height+"px",ui.kontainer.style.backgroundColor="#000000",_.ej=[],_.ej[0]=0,_.ej[1]=-2,_.ej[2]=Math.PI,_.ej[3]=0,_.ej[4]=0,_.ej[5]=0,x.xx=400,(renderer=new e.WebGLRenderer({antialias:!0,alpha:!1})).setPixelRatio(window.devicePixelRatio),renderer.setSize(_.width,_.height),renderer.setClearColor(0,1),renderer.shadowMap.enabled=!0,renderer.shadowMap.type=e.PCFSoftShadowMap,renderer.outputColorSpace=e.LinearSRGBColorSpace,renderer.sortObjects=!1,ui.kontainer.appendChild(renderer.domElement),!1===renderer.capabilities.isWebGL2&&!renderer.extensions.get("OES_texture_float"))throw alert("OES_texture_float not supported"),"missing webgl extension";if(!1===renderer.capabilities.isWebGL2&&!renderer.extensions.get("OES_texture_float_linear"))throw alert("OES_texture_float_linear not supported"),"missing webgl extension";scene=new e.Scene,x.camGrup=new e.Group,grups[0]=new e.Group,grups[1]=new e.Group,(camera=new e.PerspectiveCamera(50,_.width/_.height,.5,2e4)).position.set(0,0,1280),x.camGrup.add(camera),scene.add(new e.AmbientLight(3355443));let i=new e.DirectionalLight(16776434,4);i.position.set(-1,0,0),scene.add(i),scene.add(x.camGrup),eL(window,1,"load",init),eL(window,0,"resize",onWindowResize),(clock=new e.Clock).autoStart=!1,_.mouse=new e.Vector2,_.entro=!0,_.idleTimer=0,_.fokus=!0,_.pointer=new e.Vector2,_.ptrDown=!1,x.currGrup=0,x.targetO=new e.Object3D,x.target1=new e.Object3D,x.target1.position.set(0,0,x.camGrup.position.z),scene.add(x.target1),addSkybox(),onWindowResize()}function addSkybox(){let t=".png",n=new e.CubeTextureLoader;n.setPath("img/skybox/5/"),n.load(["posx"+t,"negx"+t,"posy"+t,"negy"+t,"posz"+t,"negz"+t],function(e){x.skybox=e,scene.background=x.skybox,addEarth(),addMoon()})}function addEarth(){let t=new e.SphereGeometry(400,80,40),n=new e.MeshStandardMaterial({color:16777215,emissive:12500670,roughness:.6});x.Earth=new e.Mesh(t,n),x.Earth.position.set(300,0,0),grups[0].add(x.Earth),scene.add(grups[0]);let i=new e.PlaneGeometry(950,950),o=new e.MeshBasicMaterial({color:11195903,transparent:!0,opacity:0});o.depthWrite=!1,x.mGlow=new e.Mesh(i,o),x.mGlow.position.set(250,0,0),grups[0].add(x.mGlow);let a=new e.SphereGeometry(402.8,80,40),r=new e.MeshStandardMaterial({color:16777215,transparent:!0,opacity:0});r.depthWrite=!1,x.Clouds=new e.Mesh(a,r),x.Clouds.position.set(300,0,0),grups[0].add(x.Clouds);let d=new e.TextureLoader,s=new e.TextureLoader,l=new e.TextureLoader,u=new e.TextureLoader,$=new e.TextureLoader,p="clouds3k";isMobil&&(p="clouds2k"),d.load("img/earth/color4.jpg",function(e){x.Earth.material.map=e,x.Earth.material.needsUpdate=!0,addSun()}),s.load("img/earth/emissive1.jpg",function(e){x.Earth.material.emissiveMap=e,x.Earth.material.needsUpdate=!0}),l.load("img/earth/rough1.jpg",function(e){x.Earth.material.roughnessMap=e,x.Earth.material.needsUpdate=!0}),u.load("img/spotL3.jpg",function(e){x.mGlow.material.alphaMap=e,x.mGlow.material.opacity=.73,x.mGlow.material.needsUpdate=!0}),$.load("img/earth/"+p+".jpg",function(e){x.Clouds.material.alphaMap=e,x.Clouds.material.opacity=1,x.Clouds.material.needsUpdate=!0})}function addMoon(){let t=new e.SphereGeometry(109,38,19),n=new e.MeshStandardMaterial({color:16777215,roughness:.5});x.Moon=new e.Mesh(t,n),x.Moon.position.set(-500,0,-400),x.Moon.rotation.set(0,-(Math.PI/4),0),grups[0].add(x.Moon);let i=new e.TextureLoader,o=new e.TextureLoader;i.load("img/earth/moon/color2k.jpg",function(e){x.Moon.material.map=e,x.Moon.material.needsUpdate=!0}),o.load("img/earth/moon/bump1.jpg",function(e){x.Moon.material.bumpScale=1,x.Moon.material.bumpMap=e,x.Moon.material.needsUpdate=!0})}function addSun(){let t=new e.PlaneGeometry(3e3,3e3),n=new e.MeshBasicMaterial({color:16777215,transparent:!0,opacity:1});n.depthWrite=!1,x.Sun=new e.Mesh(t,n),x.Sun.position.set(-3e3,0,0),x.Sun.rotation.set(0,Math.PI/2,0),grups[0].add(x.Sun);let i=new e.PlaneGeometry(1e4,1e4),o=new e.MeshBasicMaterial({color:16777215,transparent:!0,opacity:.4});o.depthWrite=!1,x.SunBg=new e.Mesh(i,o),x.SunBg.position.set(-3000.1,0,-100),x.SunBg.rotation.set(0,Math.PI/2,0),grups[0].add(x.SunBg);let a=new e.TextureLoader,r=new e.TextureLoader;a.load("img/sun/color1.jpg",function(e){x.Sun.material.map=x.SunBg.material.map=e,x.Sun.material.needsUpdate=x.SunBg.material.needsUpdate=!0}),r.load("img/sun/alfa1.jpg",function(e){x.Sun.material.alphaMap=x.SunBg.material.alphaMap=e,x.Sun.material.needsUpdate=x.SunBg.material.needsUpdate=!0,fadeScene()})}function fadeScene(){onWindowResize(),function t(){let n=parseFloat(ui.fader.style.opacity);(n-=.05)<0?(ui.fader.style.opacity=0,ui.fader.style.display="none",ui.fader.parentNode.removeChild(ui.fader),onWindowResize(),eL(ui.kontainer,0,"pointerdown",onPointerDown),eL(ui.kontainer,0,"pointermove",onPointerMove),x.camV3=new e.Vector3,animate(),theOptions(),cL(ui.loadr,0,"paus"),ui.loadr.style.display="none",ui.loadr.parentNode.removeChild(ui.loadr)):(ui.fader.style.opacity=n,requestAnimationFrame(t))}()}function theOptions(){isMobil?(eL(ui.onAud,0,"touchstart",audClick),eL(ui.offAud,0,"touchstart",audClick)):(eL(ui.onAud,0,"click",audClick),eL(ui.offAud,0,"click",audClick))}function audClick(e){e&&e.preventDefault(),x.sound?x.sound.isPlaying?(cL(ui.offAud,0,"noneIt2"),cL(ui.onAud,1,"noneIt2"),x.sound.pause()):(cL(ui.onAud,0,"noneIt2"),cL(ui.offAud,1,"noneIt2"),x.sound.play()):addAud(),_.idleTimer=0}function onPointerDown(e){e&&e.preventDefault();let t={};e.clientX?(t.x=e.clientX/_.width*2-1,t.y=-(2*(e.clientY/_.height))+1):(t.x=e.x/_.width*2-1,t.y=-(2*(e.y/_.height))+1),_.ptrDown=!0,_.pointer.x=t.x,_.pointer.y=t.y,_.idleTimer=0}function onPointerMove(e){e&&e.preventDefault();let t={};e.clientX?(t.x=e.clientX/_.width*2-1,t.y=-(2*(e.clientY/_.height))+1):(t.x=e.x/_.width*2-1,t.y=-(2*(e.y/_.height))+1),_.pointer.x=t.x,_.pointer.y=t.y,_.idleTimer=0}function wheelE(e){e&&e.preventDefault(),_.idleTimer=0}function onWindowResize(){_.width=window.innerWidth,_.height=window.innerHeight,isMobil&&(_.width==_.prevW&&(_.width=_.prevH,_.height=_.prevW),_.prevW=_.width,_.prevH=_.height),_.widthH=_.width/2,_.heightH=_.height/2,document.body.style.width=ui.kontainer.style.width=_.width+"px",document.body.style.height=ui.kontainer.style.height=_.height+"px",camera.aspect=_.width/_.height,camera.updateProjectionMatrix(),renderer.setSize(_.width,_.height),x.xx=400,_.width>_.height?(cntnt.style.fontSize=cntnt2.style.fontSize=(_.width+_.height)/2*.022+"px",isMobil&&(x.xx=800)):(cntnt.style.fontSize=cntnt2.style.fontSize=(_.width+_.height)/2*.028+"px",isMobil&&(x.xx=1100)),_.idleTimer=0}function animate(){if(requestAnimationFrame(animate),_.idleTimer<120){clock.running||clock.start();let e=2e-4*Date.now();if(isMobil){let t=Math.sin(e);camera.position.x=t*x.xx,camera.position.y=700*t,x.camGrup.rotation.y=.6*Math.cos(e)}else{camera.position.x=_.pointer.x*x.xx;let n=700*_.pointer.y;camera.position.y=n,x.camGrup.rotation.y=.6*Math.cos(e)}x.SunBg.material.opacity=x.camGrup.rotation.y;let i=x.Earth.rotation.y+.003;i>=2*Math.PI&&(i%=2*Math.PI),x.Earth.rotation.y=i;let o=x.Clouds.rotation.y+.0045;o>=2*Math.PI&&(o%=2*Math.PI),x.Clouds.rotation.y=o,_.idleTimer+=.01,render()}else clock.running&&clock.stop(),x.sound&&x.sound.isPlaying&&x.sound.pause();document.hasFocus()?_.fokus||(_.idleTimer=0,_.fokus=!0,x.sound&&!x.sound.isPlaying&&x.sound.play()):(_.idleTimer=120,_.fokus=!1,x.sound&&x.sound.isPlaying&&x.sound.pause())}function render(){camera.lookAt(x.target1.position),x.mGlow.lookAt(camera.getWorldPosition(x.camV3)),renderer.render(scene,camera)}function addAud(){if(!x.sound){let t="rth";t+=".mp3";let n=new e.AudioListener;camera.add(n),x.sound=new e.Audio(n);let i=new e.AudioLoader;i.load("aud/"+t,function(e){x.sound.setBuffer(e),x.sound.setLoop(!0),x.sound.setVolume(1),x.sound.play(),cL(ui.onAud,0,"noneIt2"),cL(ui.offAud,1,"noneIt2")})}}
	