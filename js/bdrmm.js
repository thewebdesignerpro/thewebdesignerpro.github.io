/**
 * author Armstrong "Army" Chiu
 * URL: https://thewebdesignerpro.com/     
 */
 
 
import*as e from"three";import t from"three/addons/capabilities/WebGL.js";import{OBJLoader as a}from"three/addons/loaders/OBJLoader.js";import{Water as o}from"three/addons/objects/Water.js";let idleTO=120,florY=-1,ceilY=140,camera,scene,renderer,clock,grups=[],isMobil=!1,mouseX=0,mouseY=-50,mixer,ui={},_={},x={};if(t.isWebGL2Available())window.addEventListener?window.addEventListener("load",init,!1):window.attachEvent?window.attachEvent("onload",init):window.onload=init;else{let n=t.getWebGL2ErrorMessage();kontainer.appendChild(n),kontainer.style.background="url('img/bedrooml.jpg') center top no-repeat",kontainer.style.backgroundSize="cover",fader.style.opacity=0,fader.style.display="none",fader.parentNode.removeChild(fader),cL(loadr,0,"paus"),loadr.style.display="none",loadr.parentNode.removeChild(loadr)}function eL(e,t,a,o){0==t?e.addEventListener(a,o,!1):e.removeEventListener(a,o,!1)}function cL(e,t,a){0==t?e.classList.contains(a)||e.classList.add(a):e.classList.contains(a)&&e.classList.remove(a)}function init(){function t(e){return document.getElementById(e)}ui.kontainer=t("kontainer"),ui.swtchKam=t("swtchKam"),ui.onAud=t("onAud"),ui.offAud=t("offAud"),ui.swtchKam.style.visibility="hidden",ui.loadr=t("loadr"),ui.fader=t("fader"),ui.fader.style.opacity=1;let a=document.createElement("div");if(a.setAttribute("id","dummy"),document.body.appendChild(a),(isMobil="9000px"!=window.getComputedStyle(a,null).getPropertyValue("left"))&&(document.addEventListener("gesturechange",function(e){e.preventDefault()},!1),ui.kontainer.addEventListener("gesturechange",function(e){e.preventDefault()},!1),_.prevW=_.prevH=0),a.parentNode.removeChild(a),_.width=window.innerWidth,_.height=window.innerHeight,document.body.style.width=ui.kontainer.style.width=_.width+"px",document.body.style.height=ui.kontainer.style.height=_.height+"px",ui.kontainer.style.backgroundColor="#eaeff2",_.ej=[],_.ej[0]=0,_.ej[1]=-1,_.ej[2]=Math.PI,_.ej[3]=0,_.ej[4]=0,_.ej[5]=20,x.zz=450,(renderer=new e.WebGLRenderer({antialias:!0,alpha:!1})).setPixelRatio(window.devicePixelRatio),renderer.setSize(_.width,_.height),renderer.setClearColor(15396850,1),renderer.shadowMap.enabled=!0,renderer.shadowMap.type=e.PCFSoftShadowMap,renderer.toneMapping=e.ACESFilmicToneMapping,renderer.outputColorSpace=e.LinearSRGBColorSpace,renderer.sortObjects=!1,ui.kontainer.appendChild(renderer.domElement),!1===renderer.capabilities.isWebGL2&&!renderer.extensions.get("OES_texture_float"))throw alert("OES_texture_float not supported"),"missing webgl extension";if(!1===renderer.capabilities.isWebGL2&&!renderer.extensions.get("OES_texture_float_linear"))throw alert("OES_texture_float_linear not supported"),"missing webgl extension";scene=new e.Scene,x.camGrup=new e.Group,grups[0]=new e.Group,grups[1]=new e.Group,(camera=new e.PerspectiveCamera(50,_.width/_.height,.5,1e4)).position.set(0,_.ej[5],400),x.camGrup.add(camera),scene.add(new e.AmbientLight(15658734)),x.spotLight=[],x.spotLight[0]=new e.SpotLight(16775925,5e6,1500,Math.PI/8,1),x.spotLight[0].position.set(800,500,50),x.spotLight[0].castShadow=!0,x.spotLight[0].shadow.mapSize.width=1536,x.spotLight[0].shadow.mapSize.height=1536,x.spotLight[0].shadow.camera.near=1,x.spotLight[0].shadow.camera.far=1500,x.spotLight[0].shadow.camera.fov=50,x.spotLight[0].shadow.intensity=.5,scene.add(x.spotLight[0]),x.camGrup.position.set(0,0,_.ej[3]),scene.add(x.camGrup),eL(window,1,"load",init),eL(window,0,"resize",onWindowResize),(clock=new e.Clock).autoStart=!1,_.mouse=new e.Vector2,_.entro=!0,_.idleTimer=0,_.fokus=!0,_.pointer=new e.Vector2,_.ptrDown=!1,x.currGrup=0,x.target0=new e.Object3D,x.target0.position.set(0,_.ej[5]-10,50),scene.add(x.target0),x.spotLight[0].target=x.target0,x.rotCam=!1,addSkybox(),addBg(),addTables(),addSea(),onWindowResize()}function addSkybox(){let t=".jpg",a=new e.CubeTextureLoader;a.setPath("img/skybox/2/"),a.load(["posx"+t,"negx"+t,"posy"+t,"negy"+t,"posz"+t,"negz"+t],function(t){t.colorSpace=e.LinearSRGBColorSpace,x.skybox=t,addRoom(),addBull(),addBear(),addPlants()})}function addBg(){let t=new e.SphereGeometry(470,8,4,0,Math.PI/1.5,Math.PI/4,Math.PI/2),a=new e.MeshBasicMaterial({color:16777215,side:1}),o=new e.Mesh(t,a);o.position.set(300,30,10),o.rotation.y=Math.PI/1.3,scene.add(o);let n=new e.TextureLoader;n.load("img/skybox/15/bg.jpg",function(e){a.map=e,a.needsUpdate=!0})}function addRoom(){let t=0,o=new a;o.load("obj/room/0/room.obj",function(a){a.traverse(function(e){e.isMesh&&(e.geometry.computeBoundingBox(),10!=t&&(e.castShadow=!0),e.receiveShadow=!0,t+=1)}),x.room=a,x.room.position.set(0,-100,0),x.room.rotation.set(0,Math.PI/2,0);let o=[],n="obj/room/0/mat/",r="img/fabric/0/",i="img/marble/0/",d=[12105138,16777215,12698828,12303291,16777215,13489371,14540253,11711154,16777215,11184810,14540253,11184810,16777215],s=[1,1,.7,1,1,.15,1,1,1,1,.9,.1,.1];for(let l=0;l<t;l++)o[l]=new e.MeshStandardMaterial({color:d[l],roughness:s[l],metalness:0}),10==l&&(o[l].transparent=!0,o[l].opacity=.75),11==l&&(o[l].metalness=.25),12==l&&o[l].emissive.setHex(3815994),(5==l||11==l||12==l)&&(o[l].envMap=x.skybox),x.room.children[l].material=o[l];grups[0].add(x.room),scene.add(grups[0]);let p=new e.TextureLoader,c=new e.TextureLoader,$=new e.TextureLoader,u=new e.TextureLoader,m=new e.TextureLoader,h=new e.TextureLoader,f=new e.TextureLoader,w=new e.TextureLoader,g=(new e.TextureLoader,new e.TextureLoader),y=new e.TextureLoader,b=new e.TextureLoader;p.load(r+"normal1.jpg",function(t){t.wrapS=t.wrapT=e.RepeatWrapping,t.repeat.set(7,7),x.room.children[0].material.normalScale.set(.35,.35),x.room.children[0].material.normalMap=t,x.room.children[0].material.needsUpdate=!0}),c.load("img/bakrum/carpetc.jpg",function(t){t.wrapS=t.wrapT=e.RepeatWrapping,t.repeat.set(1.4,1.4),x.room.children[2].material.map=t,x.room.children[2].material.needsUpdate=!0}),$.load("img/bakrum/carpetd.jpg",function(t){t.wrapS=t.wrapT=e.RepeatWrapping,t.repeat.set(1.4,1.4),x.room.children[2].material.bumpScale=16,x.room.children[2].material.bumpMap=t,x.room.children[2].material.needsUpdate=!0}),u.load(n+"marble.jpg",function(e){x.room.children[5].material.map=e,x.room.children[5].material.needsUpdate=!0}),m.load(r+"color1.jpg",function(t){t.wrapS=t.wrapT=e.RepeatWrapping,t.repeat.set(5.8,5.8),x.room.children[6].material.map=t,x.room.children[6].material.needsUpdate=!0}),h.load(r+"rough1.jpg",function(t){t.wrapS=t.wrapT=e.RepeatWrapping,t.repeat.set(5.8,5.8),x.room.children[6].material.roughnessMap=t,x.room.children[6].material.needsUpdate=!0}),f.load(r+"normal1.jpg",function(t){t.wrapS=t.wrapT=e.RepeatWrapping,t.repeat.set(5.8,5.8),x.room.children[4].material.normalScale.set(.3,.3),x.room.children[6].material.normalScale.set(.75,.75),x.room.children[4].material.normalMap=x.room.children[6].material.normalMap=t,x.room.children[4].material.needsUpdate=x.room.children[6].material.needsUpdate=!0}),w.load(r+"normal1.jpg",function(t){t.wrapS=t.wrapT=e.RepeatWrapping,t.repeat.set(3,3),t.center.set(.5,.5),t.rotation=Math.PI/4,x.room.children[7].material.normalScale.set(-.35,-.35),x.room.children[7].material.normalMap=t,x.room.children[7].material.needsUpdate=!0}),g.load(i+"color1.jpg",function(t){t.wrapS=t.wrapT=e.RepeatWrapping,t.repeat.set(4.2,3),x.room.children[10].material.map=t,x.room.children[10].material.needsUpdate=!0}),y.load(i+"rough1.jpg",function(t){t.wrapS=t.wrapT=e.RepeatWrapping,t.repeat.set(4.2,3),x.room.children[10].material.roughnessMap=t,x.room.children[10].material.needsUpdate=!0}),b.load(n+"deck.jpg",function(e){x.room.children[12].material.map=e,x.room.children[12].material.needsUpdate=!0});let L=new e.PlaneGeometry(240,195),M=new e.MeshBasicMaterial({color:15658734,transparent:!0,opacity:.2});M.depthWrite=!1,M.reflectivity=.8,M.envMap=x.skybox;let S=new e.Mesh(L,M);S.position.set(333,52,52),S.rotation.set(0,-(Math.PI/2),0),scene.add(S);let v=new e.PlaneGeometry(544,164),j=new e.MeshBasicMaterial({color:16766148,transparent:!0,opacity:.8}),T=new e.Mesh(v,j);T.position.set(0,103,-138.1),scene.add(T);let k=new e.TextureLoader;k.load(n+"glow1.png",function(e){j.map=j.alphaMap=e,j.needsUpdate=!0}),addRays(),addLamps(),fadeScene()})}function addRays(){let t=[],a=[0,-13,-26,-39,-52,-65,-78,-91,-104,-117,-103,-129,-150],o=-(Math.PI/4),n=new e.PlaneGeometry(280,400),r=new e.PlaneGeometry(280,300),i=new e.MeshBasicMaterial({color:16777215,transparent:!0,opacity:.3}),d=new e.MeshBasicMaterial({color:16777215,transparent:!0,opacity:.45});i.depthWrite=d.depthWrite=!1,i.side=d.side=2;for(let s=0;s<13;s++)s<10?(t[s]=new e.Mesh(n,i),t[s].position.z=a[s]):(t[s]=new e.Mesh(r,d),t[s].position.y=-30,t[s].position.z=a[s]),t[s].rotation.x=o-.15,12==s&&(t[s].rotation.x=o-.1),grups[1].add(t[s]);grups[1].position.set(172,23,51),grups[1].rotation.y=-(Math.PI/2);let l=new e.TextureLoader;l.load("img/rays2.png",function(e){i.alphaMap=d.alphaMap=e,i.needsUpdate=d.needsUpdate=!0,scene.add(grups[1])})}function addLamps(){let t=0;x.lamp=[];let o=new a;o.load("obj/lamp/1/lamp.obj",function(a){a.traverse(function(e){e.isMesh&&(e.geometry.computeBoundingBox(),t+=1)});let o="obj/lamp/1/mat/",n=[-110,0,110],r=a.children[0].geometry,i=new e.MeshStandardMaterial({color:16777215,emissive:16777215,roughness:.7,metalness:.3});i.envMap=x.skybox;for(let d=0;d<3;d++)x.lamp[d]=new e.Mesh(r,i),x.lamp[d].scale.set(11,15,11),x.lamp[d].position.set(n[d],78,-20),x.lamp[d].castShadow=!0,x.lamp[d].receiveShadow=!0,grups[0].add(x.lamp[d]);let s=new e.TextureLoader,l=(new e.TextureLoader,new e.TextureLoader),p=new e.TextureLoader,c=new e.TextureLoader;s.load(o+"color1.jpg",function(e){i.map=e,i.needsUpdate=!0}),s.load(o+"emissive1.jpg",function(e){i.emissiveMap=e,i.needsUpdate=!0}),l.load(o+"rough2.jpg",function(e){i.roughnessMap=e,i.needsUpdate=!0}),p.load(o+"metal1.jpg",function(e){i.metalnessMap=e,i.needsUpdate=!0}),c.load(o+"normal1.jpg",function(e){i.normalMap=e,i.needsUpdate=!0})})}function addTables(){let t=[],a=[-144,144],o=new e.BoxGeometry(70,6.2,55),n=new e.MeshStandardMaterial({color:14211288,roughness:.9,metalness:0});for(let r=0;r<2;r++)t[r]=new e.Mesh(o,n),t[r].position.set(a[r],-55,-105),t[r].castShadow=!0,t[r].receiveShadow=!0,scene.add(t[r]);let i=new e.TextureLoader;i.load("img/wood/0/rough1.jpg",function(e){n.map=n.roughnessMap=e,n.needsUpdate=!0})}function addBull(){let t=0,o=new a;o.load("obj/decor/1/bull.obj",function(a){a.traverse(function(e){e.isMesh&&(e.geometry.computeBoundingBox(),t+=1)});let o=a.children[0].geometry,n=new e.MeshStandardMaterial({color:15658734,roughness:.1,metalness:.7});n.envMap=x.skybox;let r=new e.Mesh(o,n);r.scale.set(.25,.25,.25),r.position.set(143,-52,-99),r.rotation.set(-(Math.PI/2),0,-(Math.PI/1.2)),r.castShadow=!0,r.receiveShadow=!0,grups[0].add(r)})}function addBear(){let t=0,o=new a;o.load("obj/decor/2/bear.obj",function(a){a.traverse(function(e){e.isMesh&&(e.geometry.computeBoundingBox(),t+=1)});let o=a.children[0].geometry,n=new e.MeshStandardMaterial({color:15658734,roughness:.2,metalness:.6});n.envMap=x.skybox;let r=new e.Mesh(o,n);r.scale.set(.27,.27,.27),r.position.set(-138,-52,-99),r.rotation.set(-(Math.PI/2),0,Math.PI/3.4),r.castShadow=!0,r.receiveShadow=!0,grups[0].add(r)})}function addPlants(){let t=0;x.plant=[];let o=new a;o.load("obj/plants/0/plants.obj",function(a){a.traverse(function(e){e.isMesh&&(e.geometry.computeBoundingBox(),t+=1)});let o="obj/plants/0/mat/",n=[-220,220],r=a.children[0].geometry,i=new e.MeshStandardMaterial({color:16777215,roughness:.5,metalness:0});i.alphaTest=.5;for(let d=0;d<2;d++)x.plant[d]=new e.Mesh(r,i),x.plant[d].scale.set(40,40,40),x.plant[d].position.set(n[d],-50,-99),0==d&&(x.plant[d].rotation.y=-(Math.PI/4)),x.plant[d].castShadow=!0,x.plant[d].receiveShadow=!0,grups[0].add(x.plant[d]);let s=new e.TextureLoader,l=new e.TextureLoader;s.load(o+"color2.jpg",function(e){i.map=e,i.needsUpdate=!0}),l.load(o+"alfa2.jpg",function(e){i.alphaMap=e,i.needsUpdate=!0})})}function addSea(){let t=new e.PlaneGeometry(550,778);x.sea=new o(t,{textureWidth:640,textureHeight:640,waterNormals:new e.TextureLoader().load("img/water/waternormals.jpg",function(t){t.wrapS=t.wrapT=e.RepeatWrapping}),sunDirection:new e.Vector3,sunColor:16777215,waterColor:2236962,distortionScale:2,fog:void 0!==scene.fog}),x.sea.position.set(0,-100,250),x.sea.rotation.x=-Math.PI/2,scene.add(x.sea);let a=x.sea.material.uniforms;a.size.value=.1}function fadeScene(){onWindowResize(),function t(){let a=parseFloat(ui.fader.style.opacity);(a-=.05)<0?(ui.fader.style.opacity=0,ui.fader.style.display="none",ui.fader.parentNode.removeChild(ui.fader),onWindowResize(),eL(ui.kontainer,0,"pointerdown",onPointerDown),eL(ui.kontainer,0,"pointermove",onPointerMove),x.camV3=new e.Vector3,animate(),theOptions(),cL(ui.loadr,0,"paus"),ui.loadr.style.display="none",ui.loadr.parentNode.removeChild(ui.loadr),x.fogIdx=0,x.fogInc=1):(ui.fader.style.opacity=a,requestAnimationFrame(t))}()}function theOptions(){isMobil?ui.swtchKam.style.display="none":ui.swtchKam.style.visibility="visible",isMobil?(eL(ui.swtchKam,0,"touchstart",swtchKamClick),eL(ui.onAud,0,"touchstart",audClick),eL(ui.offAud,0,"touchstart",audClick)):(eL(ui.swtchKam,0,"click",swtchKamClick),eL(ui.onAud,0,"click",audClick),eL(ui.offAud,0,"click",audClick))}function swtchKamClick(e){e&&e.preventDefault(),x.rotCam=!x.rotCam,_.idleTimer=0}function audClick(e){e&&e.preventDefault(),x.sound?x.sound.isPlaying?(cL(ui.offAud,0,"noneIt2"),cL(ui.onAud,1,"noneIt2"),x.sound.pause()):(cL(ui.onAud,0,"noneIt2"),cL(ui.offAud,1,"noneIt2"),x.sound.play()):addAud(),_.idleTimer=0}function onPointerDown(e){e&&e.preventDefault();let t={};e.clientX?(t.x=e.clientX/_.width*2-1,t.y=-(2*(e.clientY/_.height))+1):(t.x=e.x/_.width*2-1,t.y=-(2*(e.y/_.height))+1),_.ptrDown=!0,_.pointer.x=t.x,_.pointer.y=t.y,_.idleTimer=0}function onPointerMove(e){e&&e.preventDefault();let t={};e.clientX?(t.x=e.clientX/_.width*2-1,t.y=-(2*(e.clientY/_.height))+1):(t.x=e.x/_.width*2-1,t.y=-(2*(e.y/_.height))+1),_.pointer.x=t.x,_.pointer.y=t.y,_.idleTimer=0}function wheelE(e){e&&e.preventDefault(),_.idleTimer=0}function onWindowResize(){_.width=window.innerWidth,_.height=window.innerHeight,isMobil&&(_.width==_.prevW&&(_.width=_.prevH,_.height=_.prevW),_.prevW=_.width,_.prevH=_.height,x.rotCam=!0),_.widthH=_.width/2,_.heightH=_.height/2,document.body.style.width=ui.kontainer.style.width=_.width+"px",document.body.style.height=ui.kontainer.style.height=_.height+"px",camera.aspect=_.width/_.height,camera.updateProjectionMatrix(),renderer.setSize(_.width,_.height),x.zz=450,_.width>_.height?(cntnt.style.fontSize=cntnt2.style.fontSize=(_.width+_.height)/2*.022+"px",x.zz=450):(cntnt.style.fontSize=cntnt2.style.fontSize=(_.width+_.height)/2*.028+"px",x.zz=600),camera.position.z=x.zz,_.idleTimer=0}function animate(){if(requestAnimationFrame(animate),_.idleTimer<120){clock.running||clock.start();let e=.001*Date.now();x.rotCam?(camera.position.x=220*Math.sin(.35*e),camera.position.y=120*Math.sin(.2*e)+30,camera.position.z=x.zz-.25*Math.abs(camera.position.x)):(camera.position.x=220*_.pointer.x,camera.position.y=120*_.pointer.y+30,camera.position.z=x.zz-50*Math.abs(_.pointer.x)),_.idleTimer+=.01,render()}else clock.running&&clock.stop(),x.sound&&x.sound.isPlaying&&x.sound.pause();document.hasFocus()?_.fokus||(_.idleTimer=0,_.fokus=!0,x.sound&&!x.sound.isPlaying&&x.sound.play()):(_.idleTimer=120,_.fokus=!1,x.sound&&x.sound.isPlaying&&x.sound.pause())}function render(){camera.lookAt(x.target0.position),renderer.render(scene,camera)}function addAud(){if(!x.sound){let t="bdrm";t+=".mp3";let a=new e.AudioListener;camera.add(a),x.sound=new e.Audio(a);let o=new e.AudioLoader;o.load("aud/"+t,function(e){x.sound.setBuffer(e),x.sound.setLoop(!0),x.sound.setVolume(.9),x.sound.play(),cL(ui.onAud,0,"noneIt2"),cL(ui.offAud,1,"noneIt2")})}}
	