/* Author: Armstrong Chiu
   URL: https://thewebdesignerpro.com/     */

var clock=new THREE.Clock;const floorPosY=-4,rnd1=Math.random(Math.PI);var renderer,camera,scene,controls,stats,catwalkModel,catwalkTexture,animAction,animMix,mouseX=mouseY=mouseZ=0,ww=window.innerWidth,wh=window.innerHeight,wwh=ww/2,whh=wh/2,pis=0,pif=1,ntro=!0,anims=[],cntnr=document.getElementById("container"),nv=document.getElementById("nav"),nvo=document.getElementById("nvo"),srbs=document.getElementById("serbis"),flio=document.getElementById("folio"),kont=document.getElementById("kontak"),srvc=document.getElementById("services"),prtf=document.getElementById("portfolio"),cntc=document.getElementById("contact"),cntnt=document.getElementById("content"),cntnt2=document.getElementById("content2"),cntnt3=document.getElementById("content3"),x1=document.getElementById("x1"),x2=document.getElementById("x2"),x3=document.getElementById("x3"),navOn=!1,popped="0",animSpeed=document.getElementById("animSpeed"),audVol=document.getElementById("audVol"),optn1=document.getElementById("optn1"),optn2=document.getElementById("optn2"),optn3=document.getElementById("optn3"),animP=0,startT=Date.now();if(animSpeed.value=1,audVol.value=.8,document.body.style.width=ww+"px",document.body.style.height=wh+"px",cntnr.style.width=ww+"px",cntnr.style.height=wh+"px",cntnt.style.fontSize=(ww+wh)/2*.02,document.getElementById("optn").style.opacity=document.getElementById("controlz").style.opacity=0,null!=Audio){var mus,au=new Audio,ext="ogg";au.canPlayType("audio/mp3")&&(ext="mp3"),(mus=new Audio("aud/sidewayz."+ext)).volume=.8,mus.loop=!0,mus.load(),mus.addEventListener("loadeddata",function(){startT=Date.now();var e=this.play();e&&e.catch(function(e){var t=document.createElement("div");t.id="noAud",t.innerHTML="UNMUTE",t.style.display="block",t.style.position="absolute",t.style.margin="auto",t.style.top="49%",t.style.bottom=t.style.left=t.style.right="0",t.style.width="160px",t.style.height="48px",t.style.lineHeight="44px",t.style.fontSize="24px",t.style.textAlign="center",t.style.color="rgba(255, 255, 255, 0.7)",t.style.backgroundColor="rgba(255, 255, 255, 0.15)",t.style.border="2px solid rgba(255, 255, 255, 0.7)",t.style.cursor="pointer",t.style.zIndex=100,container.addEventListener("click",containerClick,!1),container.appendChild(t)})},!1)}else startT=Date.now();function init(){(camera=new THREE.PerspectiveCamera(50,ww/wh,1,5e3)).position.set(0,1,15),(scene=new THREE.Scene).fog=new THREE.FogExp2(0,.003),camera.lookAt(scene.position);var e=new THREE.AmbientLight(2368548);scene.add(e);var t=new THREE.SpotLight(16777215,1.5,100,Math.PI/6,.7);t.position.set(0,10,10),t.castShadow=!0,t.shadow.mapSize.width=1024,t.shadow.mapSize.height=1024,t.shadow.camera.near=5,t.shadow.camera.far=200,t.shadow.camera.fov=40,scene.add(t),(renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!0})).setPixelRatio(window.devicePixelRatio),renderer.setSize(ww,wh),renderer.setClearColor(0,1),renderer.shadowMap.enabled=!0,renderer.shadowMapSoft=!0,renderer.shadowMap.type=THREE.PCFSoftShadowMap,renderer.sortObjects=!1,document.getElementById("container").appendChild(renderer.domElement),(controls=new THREE.OrbitControls(camera,renderer.domElement)).enableDamping=!0,controls.dampingFactor=.25,controls.minDistance=2,controls.maxDistance=100,sahig(),loadModelCatwalk()}function sahig(){var e=new THREE.PlaneBufferGeometry(300,300),t=new THREE.MeshStandardMaterial({color:4473924,roughness:.6,metalness:.3,transparent:!0,opacity:.8}),n=new THREE.Mesh(e,t);n.rotateX(Math.PI/-2),n.position.y=floorPosY,n.receiveShadow=!0,scene.add(n);var o=new THREE.MeshStandardMaterial({color:4473924,roughness:.6,metalness:.3}),a=new THREE.Mesh(e,o);a.rotateX(Math.PI/-2),a.position.y=floorPosY-.1,scene.add(a)}function loadModelCatwalk(){var e=new THREE.MeshStandardMaterial({color:14932681,roughness:.63,metalness:.1,skinning:!0,fog:!1}),t=new THREE.JSONLoader;animMix=new THREE.AnimationMixer(scene),t.load("obj/skel40.json",function(t,n){(catwalkModel=new THREE.SkinnedMesh(t,e)).scale.set(1,1,1),catwalkModel.position.y=floorPosY,catwalkModel.castShadow=catwalkModel.receiveShadow=!0,catwalkModel.matrixAutoUpdate=!1,catwalkModel.updateMatrix(),scene.add(catwalkModel),anims[0]=t.animations[0],anims[1]=t.animations[1],anims[2]=t.animations[2],animMix.clipAction(anims[0],catwalkModel).play(),animMix.timeScale=.1,animMix.loop=!1,animP=0,animate()})}function animate(){requestAnimationFrame(animate);var e=clock.getDelta();ntro&&(pif>0?(pif-=.0025,document.getElementById("pinfo2").style.opacity=pif,pif<=.5&&(pis+=.0025,document.getElementById("optn").style.opacity=pis,document.getElementById("controlz").style.opacity=pis)):(document.getElementById("pinfo2").style.opacity=0,document.getElementById("optn").style.opacity=.5,document.getElementById("controlz").style.opacity=.5,ntro=!1,animMix.timeScale=animSpeed.value)),animMix.update(e),render()}function render(){camera.lookAt(scene.position),controls.update(),renderer.render(scene,camera)}function stopAnim(e){switch(animP){case 0:animMix.clipAction(anims[0],catwalkModel).stop();break;case 1:animMix.clipAction(anims[1],catwalkModel).stop();break;case 2:animMix.clipAction(anims[2],catwalkModel).stop()}if(e)return e()}function containerClick(e){e.preventDefault(),mus.play(),container.removeEventListener("click",containerClick,!1),noAud.parentNode.removeChild(noAud)}window.addEventListener?window.addEventListener("load",init,!1):window.attachEvent?window.attachEvent("onload",init):window.onload=init,animSpeed.addEventListener("input",function(e){animMix.timeScale=this.value},!1),audVol.addEventListener("input",function(e){mus.volume=this.value},!1),optn1.addEventListener("click",function(e){stopAnim(function(e){animMix.clipAction(anims[0],catwalkModel).play(),animP=0}),optn2.classList.remove("sel"),optn3.classList.remove("sel"),optn1.classList.add("sel"),e.preventDefault()}),optn2.addEventListener("click",function(e){stopAnim(function(e){animMix.clipAction(anims[1],catwalkModel).play(),animP=1}),optn1.classList.remove("sel"),optn3.classList.remove("sel"),optn2.classList.add("sel"),e.preventDefault()}),optn3.addEventListener("click",function(e){stopAnim(function(e){animMix.clipAction(anims[2],catwalkModel).play(),animP=2}),optn1.classList.remove("sel"),optn2.classList.remove("sel"),optn3.classList.add("sel"),e.preventDefault()});