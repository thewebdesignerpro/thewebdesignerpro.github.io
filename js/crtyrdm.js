/**
 * author Armstrong "Army" Chiu
 * URL: https://thewebdesignerpro.com/     
 */
 
import*as e from"three";import t from"three/addons/capabilities/WebGL.js";import{OBJLoader as a}from"three/addons/loaders/OBJLoader.js";let idleTO=120,florY=-10,ceilY=140,camera,scene,renderer,clock,grups=[],isMobil=!1,mouseX=0,mouseY=-50,mixer,ui={},_={},x={};if(t.isWebGL2Available())window.addEventListener?window.addEventListener("load",init,!1):window.attachEvent?window.attachEvent("onload",init):window.onload=init;else{let r=t.getWebGL2ErrorMessage();kontainer.appendChild(r),kontainer.style.background="url('img/thewebdesignerprol.jpg') center top no-repeat",kontainer.style.backgroundSize="cover",fader.style.opacity=0,fader.style.display="none",fader.parentNode.removeChild(fader),cL(loadr,0,"paus"),loadr.style.display="none",loadr.parentNode.removeChild(loadr)}function eL(e,t,a,r){0==t?e.addEventListener(a,r,!1):e.removeEventListener(a,r,!1)}function cL(e,t,a){0==t?e.classList.contains(a)||e.classList.add(a):e.classList.contains(a)&&e.classList.remove(a)}function init(){function t(e){return document.getElementById(e)}ui.kontainer=t("kontainer"),ui.onAud=t("onAud"),ui.offAud=t("offAud"),ui.loadr=t("loadr"),ui.fader=t("fader"),ui.fader.style.opacity=1;let a=document.createElement("div");if(a.setAttribute("id","dummy"),document.body.appendChild(a),(isMobil="9000px"!=window.getComputedStyle(a,null).getPropertyValue("left"))&&(document.addEventListener("gesturechange",function(e){e.preventDefault()},!1),ui.kontainer.addEventListener("gesturechange",function(e){e.preventDefault()},!1),_.prevW=_.prevH=0),a.parentNode.removeChild(a),_.width=window.innerWidth,_.height=window.innerHeight,document.body.style.width=ui.kontainer.style.width=_.width+"px",document.body.style.height=ui.kontainer.style.height=_.height+"px",ui.kontainer.style.backgroundColor="#909496",_.ej=[],_.ej[0]=0,_.ej[1]=-2,_.ej[2]=Math.PI,_.ej[3]=0,_.ej[4]=0,_.ej[5]=0,(renderer=new e.WebGLRenderer({antialias:!0,alpha:!1})).setPixelRatio(window.devicePixelRatio),renderer.setSize(_.width,_.height),renderer.setClearColor(9475222,1),renderer.shadowMap.enabled=!0,renderer.shadowMap.type=e.PCFSoftShadowMap,renderer.outputColorSpace=e.LinearSRGBColorSpace,renderer.sortObjects=!1,ui.kontainer.appendChild(renderer.domElement),!1===renderer.capabilities.isWebGL2&&!renderer.extensions.get("OES_texture_float"))throw alert("OES_texture_float not supported"),"missing webgl extension";if(!1===renderer.capabilities.isWebGL2&&!renderer.extensions.get("OES_texture_float_linear"))throw alert("OES_texture_float_linear not supported"),"missing webgl extension";(scene=new e.Scene).fog=new e.FogExp2(9475222,.012),x.camGrup=new e.Group,grups[0]=new e.Group,(camera=new e.PerspectiveCamera(50,_.width/_.height,.5,1e4)).position.set(0,_.ej[5],10),x.camGrup.add(camera),scene.add(new e.AmbientLight(6184542)),x.spotLcone=[],x.spotLight=[],x.spotLight[0]=new e.SpotLight(16777215,3e7,7e3,Math.PI/32,1),x.spotLight[0].position.set(0,3e3,1500),x.spotLight[0].castShadow=!0,x.spotLight[0].shadow.mapSize.width=1024,x.spotLight[0].shadow.mapSize.height=1024,x.spotLight[0].shadow.camera.near=10,x.spotLight[0].shadow.camera.far=7e3,x.spotLight[0].shadow.camera.fov=40,scene.add(x.spotLight[0]),scene.add(x.camGrup),eL(window,1,"load",init),eL(window,0,"resize",onWindowResize),(clock=new e.Clock).autoStart=!1,grups[1]=new e.Group,_.mouse=new e.Vector2,_.entro=!0,_.idleTimer=0,_.fokus=!0,_.pointer=new e.Vector2,_.ptrDown=!1,x.currGrup=0,x.targetO=new e.Object3D,x.targetO.position.set(0,0,x.camGrup.position.z-100),scene.add(x.targetO),addClouds(),addCourtyard(),addGround(),addTrees(),addLamps(),addBenches(),onWindowResize()}function addSkybox(){let t=".png",a=new e.CubeTextureLoader;a.setPath("img/skybox/3/"),a.load(["posx"+t,"negx"+t,"posy"+t,"negy"+t,"posz"+t,"negz"+t],function(e){x.skybox=e,scene.background=x.skybox})}function addClouds(){let t=new e.SphereGeometry(4900,24,12,0,Math.PI),a=new e.MeshBasicMaterial({color:16777215,side:e.BackSide,fog:!1});a.transparent=!0;let r=new e.Mesh(t,a);r.rotation.set(-(Math.PI/2),0,-(Math.PI/2)),scene.add(r);let o=new e.TextureLoader,n=new e.TextureLoader;o.load("img/clouds1.jpg",function(e){r.material.map=e,r.material.needsUpdate=!0}),n.load("img/opac1.jpg",function(e){r.material.alphaMap=e,r.material.needsUpdate=!0})}function randMatrix(t){let a=new e.Vector3,r=new e.Euler,o=new e.Quaternion,n=new e.Vector3;return a.x=3e3*Math.random()-1500,a.y=50*Math.random()+-10,a.z=3e3*Math.random()-1500,r.x=Math.random()*(Math.PI/4),a.y<0&&(r.x*=-1),r.y=Math.random()*(Math.PI/4),a.x>0&&(r.y*=-1),a.z>0&&(r.y*=-1),r.z=2*Math.random()*Math.PI,o.setFromEuler(r),n.x=n.y=.3*Math.random()+1,t.compose(a,o,n)}function addCourtyard(){x.courtyard=[],x.batchedMesh=[],x.material=[];let t=new a;t.load("obj/courtyard/1/cyard.obj",function(t){t.traverse(function(e){e.isMesh&&e.geometry.computeBoundingBox()});let a=[],r=[];r[0]=r[2]=16777215,r[1]=12303291;for(let o=0;o<3;o++)a[o]=new e.MeshStandardMaterial({color:r[o],roughness:.8,metalness:.1}),x.courtyard[o]=new e.Mesh(t.children[o].geometry,a[o]),x.courtyard[o].castShadow=!0,x.courtyard[o].receiveShadow=!0,x.courtyard[o].rotation.set(0,Math.PI/2,0),x.courtyard[o].scale.set(100,100,100),grups[0].add(x.courtyard[o]);let n=new e.TextureLoader,i=new e.TextureLoader,d=new e.TextureLoader;new e.TextureLoader,n.load("obj/courtyard/1/mat/c0.jpg",function(t){t.wrapS=t.wrapT=e.RepeatWrapping,x.courtyard[0].material.map=t,x.courtyard[0].material.needsUpdate=!0}),i.load("obj/courtyard/1/mat/c1.jpg",function(t){t.wrapS=t.wrapT=e.RepeatWrapping,x.courtyard[1].material.map=t,x.courtyard[1].material.bumpMap=t,x.courtyard[1].material.bumpScale=15,x.courtyard[1].material.needsUpdate=!0}),d.load("obj/courtyard/1/mat/c2.jpg",function(t){t.wrapS=t.wrapT=e.RepeatWrapping,x.courtyard[2].material.map=t,x.courtyard[2].material.bumpMap=t,x.courtyard[2].material.bumpScale=5,x.courtyard[2].material.needsUpdate=!0})}),scene.add(grups[0]),scene.add(grups[1]),fadeScene()}function addGround(){x.floor=[],x.floorShadow=[];let t=new e.PlaneGeometry(350,350),a=new e.PlaneGeometry(350,350),r=new e.MeshStandardMaterial({color:11579568,roughness:.6,metalness:0}),o=new e.ShadowMaterial({color:0,transparent:!0,opacity:.9});for(let n=0;n<1;n++)x.floor[n]=new e.Mesh(t,r),x.floorShadow[n]=new e.Mesh(a,o),x.floor[n].position.set(0,-10.1,0),x.floorShadow[n].position.set(0,-10,0),x.floor[n].rotation.x=-.5*Math.PI,x.floorShadow[n].rotation.x=-.5*Math.PI,x.floorShadow[n].receiveShadow=!0,grups[0].add(x.floor[n]),grups[0].add(x.floorShadow[n]);var i=new e.TextureLoader,d=new e.TextureLoader,s=new e.TextureLoader;new e.TextureLoader,i.load("img/ground/1/color1.jpg",function(t){t.wrapS=t.wrapT=e.RepeatWrapping,t.repeat.set(7,7);for(let a=0;a<1;a++)x.floor[a].material.map=t,x.floor[a].material.needsUpdate=!0}),d.load("img/ground/1/rough1.jpg",function(t){t.wrapS=t.wrapT=e.RepeatWrapping,t.repeat.set(7,7),x.floor[0].material.roughnessMap=t,x.floor[0].material.needsUpdate=!0}),s.load("img/ground/1/normal2.jpg",function(t){t.wrapS=t.wrapT=e.RepeatWrapping,t.repeat.set(7,7);for(let a=0;a<1;a++)x.floor[a].material.normalScale.set(1.3,1.3),x.floor[a].material.normalMap=t,x.floor[a].material.needsUpdate=!0})}function randomizeMatrix(t,a){let r=new e.Vector3,o=new e.Euler,n=new e.Quaternion,i=new e.Vector3,d=240*Math.random()-120,s=240*Math.random()-120;return s>-73&&s<73&&d>-55&&d<55&&(d=(30*Math.random()+55)*(d<0?-1:1)),r.x=d,r.y=-10,r.z=s,o.x=-(Math.PI/2),o.y=0,o.z=2*Math.random()*Math.PI,n.setFromEuler(o),i.x=i.y=i.z=a+.25*Math.random(),t.compose(r,n,i)}function addTrees(){x.materials=[];let t=new a;t.load("obj/trees/4/tree.obj",function(t){t.traverse(function(e){e.isMesh&&(e.geometry.computeBoundingBox(),e.castShadow=!0,e.receiveShadow=!0)}),x.materials[0]=new e.MeshStandardMaterial({color:16768494,roughness:.8,metalness:0,transparent:!0}),x.materials[1]=new e.MeshStandardMaterial({color:16777215,roughness:1,metalness:0}),x.materials[0].depthWrite=!1;let a=t.children[0].geometry.attributes.position.array.length,r=t.children[1].geometry.attributes.position.array.length;x.leaves=new e.BatchedMesh(40,a,2*a,x.materials[0]),x.leaves.frustumCulled=!0,x.leaves.castShadow=!0,x.trunks=new e.BatchedMesh(40,r,2*r,x.materials[1]),x.trunks.frustumCulled=!0,x.trunks.castShadow=x.trunks.receiveShadow=!0;let o=x.leaves.addGeometry(t.children[0].geometry),n=x.trunks.addGeometry(t.children[1].geometry),i=new e.Matrix4;for(let d=0;d<40;d++){let s=x.leaves.addInstance(o),l=x.trunks.addInstance(n);i=randomizeMatrix(i,.75),x.leaves.setMatrixAt(s,i),x.trunks.setMatrixAt(l,i)}grups[0].add(x.leaves),grups[0].add(x.trunks);let u=new e.TextureLoader,p=new e.TextureLoader,c=new e.TextureLoader;new e.TextureLoader,u.load("obj/trees/4/mat/color1.jpg",function(t){t.wrapS=t.wrapT=e.RepeatWrapping,x.materials[0].map=t,x.materials[0].needsUpdate=!0}),p.load("obj/trees/4/mat/bark1.jpg",function(t){t.wrapS=t.wrapT=e.RepeatWrapping,x.materials[1].map=x.materials[0].bumpMap=t,x.materials[1].bumpScale=3,x.materials[1].needsUpdate=!0}),c.load("obj/trees/4/mat/alpha1.jpg",function(t){t.wrapS=t.wrapT=e.RepeatWrapping,x.materials[0].alphaMap=t,x.materials[0].needsUpdate=!0})})}function randomizeMatrix2(t,a,r){let o=new e.Vector3,n=new e.Euler,i=new e.Quaternion,d=new e.Vector3,s=[{x:-15,z:-14},{x:11.3,z:-14},{x:-15,z:33},{x:11.3,z:33},{x:-19,z:9},{x:15.3,z:9}];return o.x=s[r].x,o.y=-10+1.22*a,o.z=s[r].z,n.x=0,n.y=0,n.z=0,i.setFromEuler(n),d.x=d.y=d.z=a,t.compose(o,i,d)}function addLamps(){x.material=[];let t=new a;t.load("obj/lamp/2/lamp.obj",function(t){t.traverse(function(e){e.isMesh&&(e.geometry.computeVertexNormals(),e.geometry.computeBoundingBox(),e.castShadow=!0,e.receiveShadow=!0)}),x.material[0]=new e.MeshStandardMaterial({color:11711154,roughness:.9,metalness:.1});let a=t.children[0].geometry.attributes.position.array.length;x.lamps=new e.BatchedMesh(6,a,2*a,x.material[0]),x.lamps.frustumCulled=!0,x.lamps.castShadow=x.lamps.receiveShadow=!0;let r=x.lamps.addGeometry(t.children[0].geometry),o=new e.Matrix4;for(let n=0;n<6;n++){let i=x.lamps.addInstance(r);o=randomizeMatrix2(o,3,n),x.lamps.setMatrixAt(i,o)}grups[0].add(x.lamps);let d=new e.TextureLoader,s=new e.TextureLoader,l=new e.TextureLoader;new e.TextureLoader,d.load("obj/lamp/2/mat/color1.jpg",function(t){t.wrapS=t.wrapT=e.RepeatWrapping,x.material[0].map=t,x.material[0].needsUpdate=!0}),s.load("obj/lamp/2/mat/rough1.jpg",function(t){t.wrapS=t.wrapT=e.RepeatWrapping,x.material[0].roughnessMap=t,x.material[0].needsUpdate=!0}),l.load("obj/lamp/2/mat/normal1.jpg",function(t){t.wrapS=t.wrapT=e.RepeatWrapping,x.material[0].normalScale.set(.25,.25),x.material[0].normalMap=t,x.material[0].needsUpdate=!0})})}function randomizeMatrix3(t,a,r){let o=new e.Vector3,n=new e.Euler,i=new e.Quaternion,d=new e.Vector3,s=[{x:-19,z:0},{x:-19,z:18},{x:15.3,z:0},{x:15.3,z:18}];return o.x=s[r].x,o.y=-10+.46*a,o.z=s[r].z,n.x=0,n.y=0,n.z=0,i.setFromEuler(n),d.x=d.y=d.z=a,t.compose(o,i,d)}function addBenches(){x.material2=[];let t=new a;t.load("obj/bench/1/bench.obj",function(t){t.traverse(function(e){e.isMesh&&(e.geometry.computeBoundingBox(),e.castShadow=!0,e.receiveShadow=!0)}),x.material2[0]=new e.MeshStandardMaterial({color:10066329,roughness:.9,metalness:.1});let a=t.children[0].geometry.attributes.position.array.length;x.benches=new e.BatchedMesh(4,a,2*a,x.material2[0]),x.benches.frustumCulled=!0,x.benches.castShadow=x.benches.receiveShadow=!0;let r=x.benches.addGeometry(t.children[0].geometry),o=new e.Matrix4;for(let n=0;n<4;n++){let i=x.benches.addInstance(r);o=randomizeMatrix3(o,2.8,n),x.benches.setMatrixAt(i,o)}grups[0].add(x.benches);let d=new e.TextureLoader,s=new e.TextureLoader,l=new e.TextureLoader;new e.TextureLoader,d.load("obj/bench/1/mat/color1.jpg",function(t){t.wrapS=t.wrapT=e.RepeatWrapping,x.material2[0].map=t,x.material2[0].needsUpdate=!0}),s.load("obj/bench/1/mat/rough1.jpg",function(t){t.wrapS=t.wrapT=e.RepeatWrapping,x.material2[0].roughnessMap=t,x.material2[0].needsUpdate=!0}),l.load("obj/bench/1/mat/normal1.jpg",function(t){t.wrapS=t.wrapT=e.RepeatWrapping,x.material2[0].normalMap=t,x.material2[0].needsUpdate=!0})})}function fadeScene(){onWindowResize(),function e(){let t=parseFloat(ui.fader.style.opacity);(t-=.05)<0?(ui.fader.style.opacity=0,ui.fader.style.display="none",ui.fader.parentNode.removeChild(ui.fader),onWindowResize(),eL(ui.kontainer,0,"pointerdown",onPointerDown),eL(ui.kontainer,0,"pointermove",onPointerMove),animate(),theOptions(),cL(ui.loadr,0,"paus"),ui.loadr.style.display="none",ui.loadr.parentNode.removeChild(ui.loadr)):(ui.fader.style.opacity=t,requestAnimationFrame(e))}()}function theOptions(){isMobil?(eL(ui.onAud,0,"touchstart",audClick),eL(ui.offAud,0,"touchstart",audClick)):(eL(ui.onAud,0,"click",audClick),eL(ui.offAud,0,"click",audClick))}function audClick(e){e&&e.preventDefault(),x.sound?x.sound.isPlaying?(cL(ui.offAud,0,"noneIt2"),cL(ui.onAud,1,"noneIt2"),x.sound.pause()):(cL(ui.onAud,0,"noneIt2"),cL(ui.offAud,1,"noneIt2"),x.sound.play()):addAud(),_.idleTimer=0}function onPointerDown(e){e&&e.preventDefault();let t={};e.clientX?(t.x=e.clientX/_.width*2-1,t.y=-(2*(e.clientY/_.height))+1):(t.x=e.x/_.width*2-1,t.y=-(2*(e.y/_.height))+1),_.ptrDown=!0,_.pointer.x=t.x,_.pointer.y=t.y,_.idleTimer=0}function onPointerMove(e){e&&e.preventDefault();let t={};e.clientX?(t.x=e.clientX/_.width*2-1,t.y=-(2*(e.clientY/_.height))+1):(t.x=e.x/_.width*2-1,t.y=-(2*(e.y/_.height))+1),_.pointer.x=t.x,_.pointer.y=t.y,_.idleTimer=0}function wheelE(e){e&&e.preventDefault(),_.idleTimer=0}function onWindowResize(){_.width=window.innerWidth,_.height=window.innerHeight,isMobil&&(_.width==_.prevW&&(_.width=_.prevH,_.height=_.prevW),_.prevW=_.width,_.prevH=_.height),_.widthH=_.width/2,_.heightH=_.height/2,document.body.style.width=ui.kontainer.style.width=_.width+"px",document.body.style.height=ui.kontainer.style.height=_.height+"px",camera.aspect=_.width/_.height,camera.updateProjectionMatrix(),renderer.setSize(_.width,_.height),_.width>_.height?cntnt.style.fontSize=cntnt2.style.fontSize=(_.width+_.height)/2*.022+"px":cntnt.style.fontSize=cntnt2.style.fontSize=(_.width+_.height)/2*.028+"px",_.idleTimer=0}function animate(){if(requestAnimationFrame(animate),_.idleTimer<120){clock.running||clock.start();let e=8e-5*Date.now();if(clock.getDelta(),isMobil){let t=Math.sin(2*e);camera.position.x=15*t;let a=35*t;camera.position.y=a>-5?a:-5,camera.rotation.x=-.7*t}else{camera.position.x=15*_.pointer.x;let r=35*_.pointer.y;camera.position.y=r>-5?r:-5,camera.rotation.x=-.7*_.pointer.y}camera.position.z=1.75*camera.position.y+10,x.camGrup.rotation.y=2.7*Math.cos(e),_.idleTimer+=.01,render()}else clock.running&&clock.stop(),x.sound&&x.sound.isPlaying&&x.sound.pause();document.hasFocus()?_.fokus||(_.idleTimer=0,_.fokus=!0,x.sound&&!x.sound.isPlaying&&x.sound.play()):(_.idleTimer=120,_.fokus=!1,x.sound&&x.sound.isPlaying&&x.sound.pause())}function render(){renderer.render(scene,camera)}function addAud(){if(!x.sound){let t="acy";t+=".mp3";let a=new e.AudioListener;camera.add(a),x.sound=new e.Audio(a);let r=new e.AudioLoader;r.load("aud/"+t,function(e){x.sound.setBuffer(e),x.sound.setLoop(!0),x.sound.setVolume(.75),x.sound.play(),cL(ui.onAud,0,"noneIt2"),cL(ui.offAud,1,"noneIt2")})}} 

	