(function(){var e,t,y,o=function(e,t){return function(){return e.apply(t,arguments)}};y=function(){function e(){var e,t;for(e=t=0;128>t;e=++t)this.keyInfo[e]={};this._initKeyType(),this._initKeyPos()}return e.prototype.KeyType={WhiteC:0,WhiteD:1,WhiteE:2,WhiteF:3,WhiteG:4,WhiteA:5,WhiteB:6,Black:7},e.prototype.whiteKeyStep=.236,e.prototype.whiteKeyWidth=.226,e.prototype.whiteKeyHeight=.22,e.prototype.whiteKeyLength=1.5,e.prototype.blackKeyWidth=.1,e.prototype.blackKeyHeight=.24,e.prototype.blackKeyLength=1,e.prototype.blackKeyShiftCDE=.0216,e.prototype.blackKeyShiftFGAB=.034,e.prototype.blackKeyPosY=-1.9,e.prototype.blackKeyPosZ=0,e.prototype.noteDropPosZ4WhiteKey=.25,e.prototype.noteDropPosZ4BlackKey=.75,e.prototype.whiteKeyColor=11688812,e.prototype.blackKeyColor=1118481,e.prototype.keyDip=.07,e.prototype.keyUpSpeed=.03,e.prototype.keyInfo=[],e.prototype.noteToColor=function(){var e,t;return e=MusicTheory.Synesthesia.map("Steve Zieverink (2004)"),t=MIDI.pianoKeyOffset,function(y){return null==e[y-t]?0:parseInt(e[y-t].hex,16)}}(),e.prototype._initKeyType=function(){var e,t,y,o,i,p,r,n,s,h,k,a,l;for(k=this.keyInfo,t=this.KeyType,i=t.WhiteC,p=t.WhiteD,r=t.WhiteE,n=t.WhiteF,s=t.WhiteG,y=t.WhiteA,o=t.WhiteB,e=t.Black,h=l=0;10>l;h=++l)a=12*h,k[a+0].keyType=i,k[a+1].keyType=e,k[a+2].keyType=p,k[a+3].keyType=e,k[a+4].keyType=r,k[a+5].keyType=n,k[a+6].keyType=e,k[a+7].keyType=s,k[a+8].keyType=e,k[a+9].keyType=y,k[a+10].keyType=e,k[a+11].keyType=o;return a=120,k[a+0].keyType=i,k[a+1].keyType=e,k[a+2].keyType=p,k[a+3].keyType=e,k[a+4].keyType=r,k[a+5].keyType=n,k[a+6].keyType=e,k[a+7].keyType=o},e.prototype._initKeyPos=function(){var e,t,y,o,i,p,r,n,s,h,k,a,l,c,u,T,K,f,d,W;for(t=this.KeyType,a=this.keyInfo,K=this.whiteKeyStep,h=this.blackKeyShiftCDE,k=this.blackKeyShiftFGAB,i=t.WhiteC,p=t.WhiteD,r=t.WhiteE,n=t.WhiteF,s=t.WhiteG,y=t.WhiteA,o=t.WhiteB,e=t.Black,l=0,u=o,c=-8.73,T=0,a[l].keyCenterPosX=c,u=a[l].keyType,l=f=1;128>f;l=++f)u===e?a[l].keyType===e||(c+=K/2):c+=a[l].keyType===e?K/2:K,a[l].keyCenterPosX=c,u=a[l].keyType;for(u=i,W=[],l=d=0;128>d;l=++d){if(a[l].keyType===e){switch(u){case i:T=-h;break;case p:T=+h;break;case n:T=-k;break;case s:T=0;break;case y:T=+k;break;default:T=0}126===l&&(T=0),a[l].keyCenterPosX+=T}W.push(u=a[l].keyType)}return W},e}(),e=function(){function e(e,t){var y,o,i,p,r,n,s,h,k,a,l,c,u,T,K,f,d,W,b,w,E;h=e.blackKeyWidth,p=e.blackKeyHeight,r=e.blackKeyLength,i=e.blackKeyColor,w=e.whiteKeyWidth,W=e.whiteKeyHeight,b=e.whiteKeyLength,d=e.whiteKeyColor,n=e.blackKeyPosY,s=e.blackKeyPosZ,l=e.keyDip,c=e.keyInfo,T=e.keyUpSpeed,o=e.KeyType,y=o.Black,E=c[t],u=E.keyType,a=E.keyCenterPosX,u===y?(k=new THREE.BoxGeometry(h,p,r),K=new THREE.MeshPhongMaterial({color:i,shininess:20}),f=new THREE.Vector3(a,n,s)):(k=new THREE.BoxGeometry(w,W,b),K=new THREE.MeshPhongMaterial({color:d,shininess:12}),f=new THREE.Vector3(a,-2,.24)),this.model=new THREE.Mesh(k,K),this.model.position.copy(f),this.keyUpSpeed=T,this.originalY=f.y,this.pressedY=this.originalY-l}return e.prototype.press=function(){return this.model.position.y=this.pressedY,this.isPressed=!0},e.prototype.release=function(){return this.isPressed=!1},e.prototype.update=function(){var e;return this.model.position.y<this.originalY&&!this.isPressed?(e=this.originalY-this.model.position.y,this.model.position.y+=Math.min(e,this.keyUpSpeed)):void 0},e}(),t=function(){function t(t,y){this.update=o(this.update,this);var i,p,r,n;for(this.model=new THREE.Object3D,this.keys=[],p=r=0,n=t.keyInfo.length;n>=0?n>r:r>n;p=n>=0?++r:--r)i=new e(t,p),this.keys.push(i),p>20&&109>p&&this.model.add(i.model);this.model.y-=t.whiteKeyHeight/2}return t.prototype.press=function(e){return this.keys[e].press()},t.prototype.release=function(e){return this.keys[e].release()},t.prototype.update=function(){var e,t,y,o,i;for(o=this.keys,i=[],t=0,y=o.length;y>t;t++)e=o[t],i.push(e.update());return i},t}(),this.PianoKeyboardDesign=y,this.PianoKeyboard=t}).call(this);